%% Program Structure Diagram
flowchart TD
    %% Styling
    classDef program fill:#4E79A7,stroke:#2E4A6E,color:white,stroke-width:2px,font-weight:bold
    classDef instruction fill:#76B7B2,stroke:#4E8C8A,color:white,stroke-width:1.5px
    classDef cpi fill:#F28E2B,stroke:#B66D1F,color:white,stroke-width:1.5px
    
    %% Programs
    TM[Token Program]
    SM[Staking Program]
    GM[Governance Program]
    
    %% Token Program Instructions
    subgraph TM_Instructions[ ]
        TM1[Transfer]
        TM2[Mint/Burn]
        TM3[Approve/Revoke]
        TM4[Get Balance]
    end
    
    %% Staking Program Instructions
    subgraph SM_Instructions[ ]
        SM1[Create Stake]
        SM2[Withdraw Stake]
        SM3[Claim Rewards]
    end
    
    %% Governance Program Instructions
    subgraph GM_Instructions[ ]
        GM1[Create Proposal]
        GM2[Cast Vote]
        GM3[Execute Proposal]
    end
    
    %% CPIs
    CPI1[Transfer Tokens]
    CPI2[Stake Tokens]
    CPI3[Vote with Staked Tokens]
    
    %% Program Connections
    TM -->|CPI| SM
    SM -->|CPI| GM
    
    %% Instructions to Programs
    TM --> TM_Instructions
    SM --> SM_Instructions
    GM --> GM_Instructions
    
    %% CPIs to Instructions
    CPI1 -.-> TM1
    CPI2 -.-> SM1
    CPI3 -.-> GM2
    
    %% Styling
    class TM,SM,GM program
    class TM1,TM2,TM3,TM4,SM1,SM2,SM3,GM1,GM2,GM3 instruction
    class CPI1,CPI2,CPI3 cpi
    
    %% Legend
    legend[Program Interactions]
    legend -->|1. Token Program| TM
    legend -->|2. Staking Program| SM
    legend -->|3. Governance Program| GM
    
    style legend fill:#f9f9f9,stroke:#ddd,stroke-width:1px
